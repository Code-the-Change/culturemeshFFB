{% extends "base.html" %}

{% block content %}

  <!-- Post text and blurb -->
  <div class="wrapper container-fluid">
    <div class="my-2 py-1 row">
      <div class="px-2" id="cm-post-blurb">
        Post in Network:
      </div>
      <div class="px-2 pt-2 pb-3 row">
        <div class="col-1">
          <a href="/network?id={{ post['id_network'] }}" class="hidden-link">
            <i id="cm-icon" class="fas fa-users"></i>
          </a>
        </div>
        <div class="col">
          <div id="cm-post-blurb">
            <a href="/network?id={{ post['id_network'] }}" class="hidden-link">
              {{ post['network_title'] }}
            </a>
        </div>
        </div>
      </div>
      <div class="p-3 cm-post-text">
        <div class="col">
          <div class="row text-left">
            <span class="cm-username">{{ post['username'] }}</span>
            <span class="cm-time-ago">{{ post['time_ago'] }}</span>
          </div>
          <div class="row py-2">
          {{ post['post_text'] }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Post replies -->
  {% if num_replies is defined and num_replies > 0 %}
    <div class="cm-replies-box py-1">
      <div class="wrapper container-fluid p-2 pl-5">
        <div class="text-left pb-3 pl-0" id="cm-reply-header">
          Replies
        </div>

        {% for i in range(num_replies) %}
        <div class="cm-post-text p-4">
          <div class="row text-left">
            <span class="cm-username">{{ replies[i]['username'] }}</span>
            <span class="cm-time-ago">{{ replies[i]["time_ago"] }}</span>
          </div>
          <div class="row py-2">
            {{ replies[i]["reply_text"] }}
          </div>
        </div>
        {% endfor %}

      </div>
    </div>
  {% endif %}

  <!-- Add reply box -->

  <div class="wrapper container-fluid py-3">
    <iframe name="dummyframe" id="cm-dummyframe"></iframe>
    <form action="{{ post_url }}"
          method="POST"
          target="dummyframe">

      <input type="hidden" name="id_parent" value="{{ post['id'] }}">
      <input type="hidden" name="id_user" value="{{ curr_user_id }}">
      <input type="hidden" name="id_network" value="{{ post['id_network'] }}">

      <div class="cm-add-reply-div text-right">
        <textarea class="my-1 form-control"
                  rows="4"
                  id="cm-post-comment"
                  name="reply_text"
                  placeholder="Leave a reply..."></textarea>
      </div>
      <div class="col">
        <div class="row">
            <input type="submit"
              class="my-2 btn btn-secondary btn-sm pr-3"
              id="cm-reply-submit-button"
              value="Reply"/>
        </div>
        <div class="row text-right cm-small-note">
            <p>* Refresh the page after pressing the reply button.</p>
        </div>
      </div>
    </form>
  </div>

{% endblock %}
